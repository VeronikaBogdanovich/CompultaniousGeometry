(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61811,       1445]
NotebookOptionsPosition[     61162,       1419]
NotebookOutlinePosition[     61551,       1436]
CellTagsIndexPosition[     61508,       1433]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";"}], "\n", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"a", "\[NotEqual]", "0"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "35"}], "}"}], "]"}], ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "35"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "-", "2"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"i", "+", "2"}]}], ",", 
         RowBox[{"j", "\[LessEqual]", "n"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "n"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"det1", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det2", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det3", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det4", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"det1", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det2", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det3", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det4", "\[Equal]", "0"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}]}], ",", 
                   RowBox[{"a", "++"}], ",", 
                   RowBox[{"a", "=", "a"}]}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"det1", "*", "det2"}], "<", "  ", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"det3", "*", "det4"}], "\[LessEqual]", "  ", 
                    "0"}]}], ",", 
                   RowBox[{"a", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[NotEqual]", "n"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"det1", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det2", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det3", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"det4", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"det1", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det2", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det3", "\[Equal]", "0"}], "&&", 
                  RowBox[{"det4", "\[Equal]", "0"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}]}], ",", 
                   RowBox[{"a", "++"}], ",", 
                   RowBox[{"a", "=", "a"}]}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"det1", "*", "det2"}], "\[LessEqual]", " ", "0"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"det3", "*", "det4"}], "\[LessEqual]", " ", 
                    "0"}]}], ",", 
                   RowBox[{"a", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
          "}"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<\:0412\:0435\:0440\:0448\:0438\:043d\:044b \:043c\:043d\:043e\:0433\
\:043e\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a\:0430\>\"", "]"}], 
  ";"}], "\n", "P", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<\:0422\:043e\:0447\:043a\:0430\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"10", ",", "45"}], "}"}], "]"}], ",", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"10", ",", "21"}], "}"}], "]"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"p0", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{"p0", ",", "p1"}], "}"}]}], ";"}], "\n", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"Append", "[", 
      RowBox[{"P", ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
    RowBox[{"Line", "[", "p", "]"}], ",", 
    RowBox[{"Point", "/@", "P"}], ",", 
    RowBox[{"Point", "/@", "p"}], ",", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"#2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#1", "+", 
          RowBox[{"{", 
           RowBox[{".4", ",", ".4"}], "}"}]}]}], "]"}], "&"}], ",", "P"}], 
     "]"}], ",", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "10"}], ",", 
         RowBox[{"#1", "+", 
          RowBox[{"{", 
           RowBox[{".4", ",", ".4"}], "}"}]}]}], "]"}], "&"}], ",", "p"}], 
     "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7278518624413733`*^9, 3.7278519187871737`*^9}, {
   3.7278519543527718`*^9, 3.7278519718554087`*^9}, {3.7278520154936333`*^9, 
   3.7278520309247646`*^9}, {3.7278521009195843`*^9, 3.7278521107531013`*^9}, 
   3.727852147734725*^9, {3.727962462091497*^9, 3.7279626000161915`*^9}, 
   3.727962702680372*^9, 3.727964401194171*^9, {3.7281967231588316`*^9, 
   3.728196749773082*^9}, {3.728197088125476*^9, 3.728197091193469*^9}, {
   3.7281975213394265`*^9, 3.728197527834855*^9}, {3.7281975928145456`*^9, 
   3.728197685038598*^9}, 3.728198356280592*^9, {3.728198910601404*^9, 
   3.72819893291325*^9}, {3.7281991043047695`*^9, 3.728199106258212*^9}, {
   3.7284012656612616`*^9, 3.728401282623113*^9}}],

Cell[BoxData["\<\"\:0412\:0435\:0440\:0448\:0438\:043d\:044b \:043c\:043d\
\:043e\:0433\:043e\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a\:0430\"\>"]\
, "Print",
 CellChangeTimes->{
  3.7281976287767687`*^9, 3.7281976864500732`*^9, {3.728198233668453*^9, 
   3.7281982407164116`*^9}, {3.7281982743186035`*^9, 3.728198359261423*^9}, {
   3.728198918635519*^9, 3.7281989283099065`*^9}, {3.7281990815083876`*^9, 
   3.7281991069491577`*^9}, 3.728199563773431*^9, {3.728199654696105*^9, 
   3.728199764026154*^9}, 3.7281998956102395`*^9, {3.728200478162113*^9, 
   3.7282005087548447`*^9}, {3.728200543568571*^9, 3.728200601291813*^9}, {
   3.7282760478671145`*^9, 3.728276053807891*^9}, {3.7284010226234884`*^9, 
   3.7284010577158613`*^9}, {3.728401211408026*^9, 3.7284012912778807`*^9}, {
   3.728401457428301*^9, 3.728401501878874*^9}, {3.728401539770669*^9, 
   3.728401552857915*^9}, 3.7284464402965593`*^9, {3.72844954264109*^9, 
   3.7284495518001833`*^9}, {3.728449912749002*^9, 3.728449925294507*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"31", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"22", ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "31"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"28", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "26"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.727851903717929*^9, 3.727851928013155*^9}, {
   3.727852131816874*^9, 3.7278521433605814`*^9}, {3.727962464388176*^9, 
   3.727962480518002*^9}, {3.727962536524748*^9, 3.7279626027872076`*^9}, {
   3.72796268684019*^9, 3.7279627062356205`*^9}, {3.728196701982876*^9, 
   3.728196712992674*^9}, {3.728196751541933*^9, 3.7281967543314323`*^9}, {
   3.7281970803130603`*^9, 3.728197112895232*^9}, 3.7281976287957954`*^9, 
   3.728197686455574*^9, {3.7281982336840825`*^9, 3.7281982407164116`*^9}, {
   3.7281982743246083`*^9, 3.728198359261423*^9}, {3.728198918639022*^9, 
   3.7281989283174105`*^9}, {3.728199081523999*^9, 3.7281991069551644`*^9}, 
   3.728199563773431*^9, {3.728199654696105*^9, 3.728199764026154*^9}, 
   3.7281998956167393`*^9, {3.728200478167117*^9, 3.728200508757848*^9}, {
   3.7282005435725727`*^9, 3.728200601294815*^9}, {3.728276047929616*^9, 
   3.728276053807891*^9}, {3.728401022639112*^9, 3.7284010577158613`*^9}, {
   3.7284012114236526`*^9, 3.7284012912935076`*^9}, {3.728401457446351*^9, 
   3.7284015018912697`*^9}, {3.728401539783197*^9, 3.728401552870448*^9}, 
   3.728446440308153*^9, {3.728449542722685*^9, 3.728449551814714*^9}, {
   3.728449912760302*^9, 3.7284499253067503`*^9}}],

Cell[BoxData["\<\"\:0422\:043e\:0447\:043a\:0430\"\>"], "Print",
 CellChangeTimes->{
  3.7281976287767687`*^9, 3.7281976864500732`*^9, {3.728198233668453*^9, 
   3.7281982407164116`*^9}, {3.7281982743186035`*^9, 3.728198359261423*^9}, {
   3.728198918635519*^9, 3.7281989283099065`*^9}, {3.7281990815083876`*^9, 
   3.7281991069491577`*^9}, 3.728199563773431*^9, {3.728199654696105*^9, 
   3.728199764026154*^9}, 3.7281998956102395`*^9, {3.728200478162113*^9, 
   3.7282005087548447`*^9}, {3.728200543568571*^9, 3.728200601291813*^9}, {
   3.7282760478671145`*^9, 3.728276053807891*^9}, {3.7284010226234884`*^9, 
   3.7284010577158613`*^9}, {3.728401211408026*^9, 3.7284012912778807`*^9}, {
   3.728401457428301*^9, 3.728401501878874*^9}, {3.728401539770669*^9, 
   3.728401552857915*^9}, 3.7284464402965593`*^9, {3.72844954264109*^9, 
   3.7284495518001833`*^9}, {3.728449912749002*^9, 3.7284499253154583`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"23", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.727851903717929*^9, 3.727851928013155*^9}, {
   3.727852131816874*^9, 3.7278521433605814`*^9}, {3.727962464388176*^9, 
   3.727962480518002*^9}, {3.727962536524748*^9, 3.7279626027872076`*^9}, {
   3.72796268684019*^9, 3.7279627062356205`*^9}, {3.728196701982876*^9, 
   3.728196712992674*^9}, {3.728196751541933*^9, 3.7281967543314323`*^9}, {
   3.7281970803130603`*^9, 3.728197112895232*^9}, 3.7281976287957954`*^9, 
   3.728197686455574*^9, {3.7281982336840825`*^9, 3.7281982407164116`*^9}, {
   3.7281982743246083`*^9, 3.728198359261423*^9}, {3.728198918639022*^9, 
   3.7281989283174105`*^9}, {3.728199081523999*^9, 3.7281991069551644`*^9}, 
   3.728199563773431*^9, {3.728199654696105*^9, 3.728199764026154*^9}, 
   3.7281998956167393`*^9, {3.728200478167117*^9, 3.728200508757848*^9}, {
   3.7282005435725727`*^9, 3.728200601294815*^9}, {3.728276047929616*^9, 
   3.728276053807891*^9}, {3.728401022639112*^9, 3.7284010577158613`*^9}, {
   3.7284012114236526`*^9, 3.7284012912935076`*^9}, {3.728401457446351*^9, 
   3.7284015018912697`*^9}, {3.728401539783197*^9, 3.728401552870448*^9}, 
   3.728446440308153*^9, {3.728449542722685*^9, 3.728449551814714*^9}, {
   3.728449912760302*^9, 3.7284499253239307`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   LineBox[{{31, 13}, {13, 3}, {22, 18}, {11, 10}, {5, 31}, {28, 15}, {15, 
    26}, {31, 13}}], 
   {PointSize[0.02], 
    LineBox[{{23, 10}, {0, 10}}], {PointBox[{31, 13}], PointBox[{13, 3}], 
     PointBox[{22, 18}], PointBox[{11, 10}], PointBox[{5, 31}], 
     PointBox[{28, 15}], PointBox[{15, 26}]}, {PointBox[{23, 10}], 
     PointBox[{0, 10}]}, {InsetBox["1", {31.4, 13.4}], 
     InsetBox["2", {13.4, 3.4}], InsetBox["3", {22.4, 18.4}], 
     InsetBox["4", {11.4, 10.4}], InsetBox["5", {5.4, 31.4}], 
     InsetBox["6", {28.4, 15.4}], InsetBox["7", {15.4, 26.4}]}, {
     InsetBox["11", {23.4, 10.4}], InsetBox["12", {0.4, 10.4}]}}}]], "Output",
 CellChangeTimes->{{3.727851903717929*^9, 3.727851928013155*^9}, {
   3.727852131816874*^9, 3.7278521433605814`*^9}, {3.727962464388176*^9, 
   3.727962480518002*^9}, {3.727962536524748*^9, 3.7279626027872076`*^9}, {
   3.72796268684019*^9, 3.7279627062356205`*^9}, {3.728196701982876*^9, 
   3.728196712992674*^9}, {3.728196751541933*^9, 3.7281967543314323`*^9}, {
   3.7281970803130603`*^9, 3.728197112895232*^9}, 3.7281976287957954`*^9, 
   3.728197686455574*^9, {3.7281982336840825`*^9, 3.7281982407164116`*^9}, {
   3.7281982743246083`*^9, 3.728198359261423*^9}, {3.728198918639022*^9, 
   3.7281989283174105`*^9}, {3.728199081523999*^9, 3.7281991069551644`*^9}, 
   3.728199563773431*^9, {3.728199654696105*^9, 3.728199764026154*^9}, 
   3.7281998956167393`*^9, {3.728200478167117*^9, 3.728200508757848*^9}, {
   3.7282005435725727`*^9, 3.728200601294815*^9}, {3.728276047929616*^9, 
   3.728276053807891*^9}, {3.728401022639112*^9, 3.7284010577158613`*^9}, {
   3.7284012114236526`*^9, 3.7284012912935076`*^9}, {3.728401457446351*^9, 
   3.7284015018912697`*^9}, {3.728401539783197*^9, 3.728401552870448*^9}, 
   3.728446440308153*^9, {3.728449542722685*^9, 3.728449551814714*^9}, {
   3.728449912760302*^9, 3.7284499253328123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "\:0434\:043b\:044f", " ", 
    "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0438", " ", 
    "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\:0439"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "0"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0434\:043b\:044f", " ", 
     "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0438", " ", 
     "\:0441\:043e\:0432\:043f\:0430\:0434\:0430\:0435\:0442", " ", 
     "\:043b\:0438", " ", "\:0442\:043e\:0447\:043a\:0430", " ", "\:0441", 
     " ", "\:043a\:0430\:043a\:043e\:0439"}], "-", 
    RowBox[{
    "\:043b\:0438\:0431\:043e", " ", 
     "\:0432\:0435\:0440\:0448\:0438\:043d\:043e\:0439"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "\[LessEqual]", "n"}], ",", 
    RowBox[{"j", "++"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "p"}], ",", " ", 
       RowBox[{"d", "++"}]}], "]"}], "\[IndentingNewLine]", "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", " ", "[", 
   RowBox[{
    RowBox[{"d", "==", "0"}], ",", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "n"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"det", " ", "=", " ", 
           RowBox[{"Det", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p1", "-", "p0"}], ",", " ", 
              RowBox[{
               RowBox[{"P", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "-", "p0"}]}], "}"}], "]"}]}],
           " ", ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"det", "\[Equal]", "0"}], ",", " ", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "1"}], ",", 
                RowBox[{"jm", "=", "n"}], ",", 
                RowBox[{"jm", "=", 
                 RowBox[{"j", "-", "1"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "n"}], ",", 
                RowBox[{"jp", "=", "1"}], ",", 
                RowBox[{"jp", "=", 
                 RowBox[{"j", "+", "1"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"det11", " ", "=", " ", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", " ", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "jm", "]"}], "]"}], "-", "p0"}]}], "}"}], 
                "]"}]}], " ", ";", "\[IndentingNewLine]", 
              RowBox[{"det12", " ", "=", " ", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", " ", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "jp", "]"}], "]"}], "-", "p0"}]}], "}"}], 
                "]"}]}], " ", ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"det12", "<", "0"}], "&&", 
                  RowBox[{"det11", ">", "0"}]}], "||", 
                 RowBox[{
                  RowBox[{"det12", ">", "0"}], "&&", 
                  RowBox[{"det11", "<", "0"}]}]}], ",", 
                RowBox[{"b", "++"}]}], "]"}]}], "\[IndentingNewLine]", 
             "}"}]}], "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "n"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[Equal]", "n"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"det1", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"p0", "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"det2", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"p1", "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"det3", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", "p0"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"det4", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "p0"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"det1", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det2", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det3", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det4", "\[Equal]", "0"}]}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}]}], ",", 
                  RowBox[{"b", "++"}], ",", 
                  RowBox[{"b", "=", "b"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"det1", "*", "det2"}], "<", "  ", "0"}], "&&", 
                   RowBox[{
                    RowBox[{"det3", "*", "det4"}], "<", "  ", "0"}]}], ",", 
                  RowBox[{"b", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[NotEqual]", "n"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"det1", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"p0", "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"det2", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"p1", "-", 
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"det3", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", "p0"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"det4", "=", 
               RowBox[{"Det", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p1", "-", "p0"}], ",", 
                  RowBox[{
                   RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", "p0"}]}], 
                 "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"det1", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det2", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det3", "\[Equal]", "0"}], "&&", 
                 RowBox[{"det4", "\[Equal]", "0"}]}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                    "\[LessEqual]", "0"}]}], ",", 
                  RowBox[{"b", "++"}], ",", 
                  RowBox[{"b", "=", "b"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"det1", "*", "det2"}], "<", " ", "0"}], "&&", 
                   RowBox[{
                    RowBox[{"det3", "*", "det4"}], "<", " ", "0"}]}], ",", 
                  RowBox[{"b", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "}"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "b", "]"}], ",", 
        RowBox[{"Print", "[", "\"\<\:0412\:043d\:0435\>\"", "]"}], ",", 
        RowBox[{"Print", "[", "\"\<\:0412\>\"", "]"}]}], "]"}]}], "}"}], ",", 
    "\"\<\:0422\:043e\:0447\:043a\:0430 \:0441\:043e\:0432\:043f\:0430\:0434\
\:0430\:0435\:0442 c \:0432\:0435\:0440\:0448\:0438\:043d\:043e\:0439 \:043c\
\:043d\:043e\:0433\:043e\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a\:0430\
\>\""}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7281977320644774`*^9, 3.7281977515613236`*^9}, {
   3.7281978011575456`*^9, 3.728197806605356*^9}, {3.728197848745372*^9, 
   3.7281979278868237`*^9}, {3.7281982215683794`*^9, 
   3.7281982260370383`*^9}, {3.728198380589549*^9, 3.728198388512933*^9}, {
   3.7281988067640643`*^9, 3.7281988111461563`*^9}, {3.7281988723840694`*^9, 
   3.728198900436537*^9}, {3.728198939346241*^9, 3.728199072804941*^9}, {
   3.7281991263522835`*^9, 3.728199302162349*^9}, {3.728199539270002*^9, 
   3.7281995523798723`*^9}, {3.728199601376687*^9, 3.72819964711473*^9}, 
   3.7282004728273335`*^9, {3.7282005278654165`*^9, 3.7282005312698407`*^9}, {
   3.728200677928025*^9, 3.7282007166013503`*^9}, {3.728200758159671*^9, 
   3.728200956130416*^9}, {3.7282761004691706`*^9, 3.728276133169766*^9}, {
   3.728276173185175*^9, 3.7282762052902174`*^9}, {3.7283988777944665`*^9, 
   3.7283989950023227`*^9}, {3.728400212794509*^9, 3.728400213263242*^9}, {
   3.728400315937811*^9, 3.7284003204222507`*^9}, {3.728400363609832*^9, 
   3.7284003641723385`*^9}, {3.7284004046884446`*^9, 3.728400414846633*^9}, {
   3.7284004557849765`*^9, 3.7284005068348227`*^9}, {3.7284006991793036`*^9, 
   3.728400897971895*^9}, {3.72840093313343*^9, 3.728401011160016*^9}, {
   3.7284010817840614`*^9, 3.728401082987201*^9}, {3.7284011143021216`*^9, 
   3.7284011190918875`*^9}, {3.728401168922375*^9, 3.7284012057330227`*^9}, {
   3.728446433755745*^9, 3.7284464349032307`*^9}, {3.7284498531660337`*^9, 
   3.728449894791767*^9}, 3.728450025091275*^9, {3.728450142244368*^9, 
   3.7284501630362473`*^9}}],

Cell[BoxData["\<\"\:0412\"\>"], "Print",
 CellChangeTimes->{{3.728449896210649*^9, 3.728449934051265*^9}, {
   3.7284500034974117`*^9, 3.72845002863365*^9}, 3.728450163886636*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 28081, 677, 1791, "Input"],
Cell[28664, 701, 1011, 14, 36, "Print"],
Cell[29678, 717, 1719, 33, 48, "Output"],
Cell[31400, 752, 912, 12, 36, "Print"],
Cell[32315, 766, 1316, 19, 48, "Output"],
Cell[33634, 787, 1924, 29, 512, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35595, 821, 25369, 591, 2003, "Input"],
Cell[60967, 1414, 179, 2, 36, "Print"]
}, Open  ]]
}
]
*)

