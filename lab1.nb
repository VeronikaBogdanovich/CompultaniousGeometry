(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53578,       1326]
NotebookOptionsPosition[     52425,       1287]
NotebookOutlinePosition[     52767,       1302]
CellTagsIndexPosition[     52724,       1299]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "1", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p0", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"det", " ", "=", " ", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p2", "-", "p1"}], ",", " ", 
        RowBox[{"p0", "-", "p1"}]}], "}"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
      RowBox[{"Line", "[", "p", "]"}], ",", 
      RowBox[{"Point", "[", "p0", "]"}], ",", 
      RowBox[{"Point", "/@", "p"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#1", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", ".7"}], "}"}]}]}], "]"}], "&"}], ",", "p"}], 
       "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"det", ">", " ", "0"}], ",", " ", 
     "\"\<\:041b\:0435\:0432\:0435\:0435\>\"", ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"det", " ", "<", " ", "0"}], ",", " ", 
       "\"\<\:041f\:0440\:0430\:0432\:0435\:0435\>\"", ",", " ", 
       "\"\<\:041b\:0435\:0436\:0438\:0442 \:043d\:0430 \:043f\:0440\:044f\
\:043c\:043e\:0439\>\""}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.727241152351898*^9, 3.7272413353862247`*^9}, {
   3.727241420262454*^9, 3.727241677238233*^9}, {3.7272417106556892`*^9, 
   3.727241719934537*^9}, {3.7272417989680758`*^9, 3.727241835710435*^9}, {
   3.727241885595189*^9, 3.7272419004649687`*^9}, {3.727241948251226*^9, 
   3.727241972451627*^9}, {3.7272420037886972`*^9, 3.72724206893933*^9}, {
   3.727242129754755*^9, 3.727242143924608*^9}, {3.727242197824189*^9, 
   3.7272422136061077`*^9}, 3.72724226611637*^9, 3.727242923580638*^9, {
   3.7272620912066402`*^9, 3.727262140587305*^9}, {3.727262216451745*^9, 
   3.7272622587104626`*^9}, {3.7272623676409025`*^9, 3.727262401057349*^9}, {
   3.7278395343281317`*^9, 3.727839557250325*^9}, 3.727839899767115*^9}],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.02], LineBox[{{12, -11}, {-10, -14}}], 
   PointBox[{-19, -18}], {PointBox[{12, -11}], PointBox[{-10, -14}]}, {
    InsetBox["1", {12, -10.3}], InsetBox["2", {-10, -13.3}]}}]], "Output",
 CellChangeTimes->{{3.727242064413781*^9, 3.727242075710561*^9}, {
   3.727242134118387*^9, 3.727242145587845*^9}, 3.7272422174699993`*^9, 
   3.727242269657424*^9, {3.727242910812886*^9, 3.727242924254303*^9}, {
   3.7272623612539387`*^9, 3.7272624018339043`*^9}, {3.7278395372031584`*^9, 
   3.727839564437863*^9}, 3.727839900063936*^9}],

Cell[BoxData["\<\"\:041b\:0435\:0432\:0435\:0435\"\>"], "Output",
 CellChangeTimes->{{3.727242064413781*^9, 3.727242075710561*^9}, {
   3.727242134118387*^9, 3.727242145587845*^9}, 3.7272422174699993`*^9, 
   3.727242269657424*^9, {3.727242910812886*^9, 3.727242924254303*^9}, {
   3.7272623612539387`*^9, 3.7272624018339043`*^9}, {3.7278395372031584`*^9, 
   3.727839564437863*^9}, 3.7278399000795765`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "2", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p3", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p4", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp1", "=", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"p3", ",", " ", "p4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"det1", " ", "=", " ", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p4", "-", "p3"}], ",", " ", 
        RowBox[{"p1", "-", "p3"}]}], "}"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"det2", " ", "=", " ", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p4", "-", "p3"}], ",", " ", 
        RowBox[{"p2", "-", "p3"}]}], "}"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"det3", " ", "=", " ", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p2", "-", "p1"}], ",", " ", 
        RowBox[{"p3", "-", "p1"}]}], "}"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"det4", " ", "=", " ", 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p2", "-", "p1"}], ",", " ", 
        RowBox[{"p4", "-", "p1"}]}], "}"}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
      RowBox[{"Line", "[", "pp1", "]"}], ",", 
      RowBox[{"Line", "[", "pp2", "]"}], ",", 
      RowBox[{"Point", "/@", "pp1"}], ",", 
      RowBox[{"Point", "/@", "pp2"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#1", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", ".7"}], "}"}]}]}], "]"}], "&"}], ",", "pp1"}], 
       "]"}], ",", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"#1", "+", 
            RowBox[{"{", 
             RowBox[{"0", ",", ".7"}], "}"}]}]}], "]"}], "&"}], ",", "pp2"}], 
       "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"det1", "==", "0"}], "&&", " ", 
      RowBox[{"det2", "==", "0"}], "&&", " ", 
      RowBox[{"det3", "==", "0"}], "&&", " ", 
      RowBox[{"det4", "==", "0"}]}], ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "\[LessEqual]", 
         "0"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "\[LessEqual]", 
         "0"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "\[LessEqual]", 
         "0"}], "||", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"p4", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"p4", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "\[LessEqual]", 
         "0"}]}], ",", 
       "\"\<\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:0435\:0442\:0441\
\:044f\>\"", ",", 
       "\"\<\:043d\:0435 \:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\
\:0435\:0442\:0441\:044f\>\""}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"det1", "*", "det2"}], "<=", "0"}], "&&", " ", 
        RowBox[{
         RowBox[{"det3", "*", "det4"}], "<=", "0"}]}], ",", 
       "\"\<\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:0435\:0442\:0441\
\:044f\>\"", ",", 
       "\"\<\:043d\:0435 \:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\
\:0435\:0442\:0441\:044f\>\""}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.727242220541501*^9, 3.727242694831712*^9}, {
   3.727242767354927*^9, 3.727243299873767*^9}, {3.7272433448399363`*^9, 
   3.727243477998766*^9}, {3.727243511106886*^9, 3.727243551723056*^9}, {
   3.72724360382891*^9, 3.727243649843515*^9}, {3.727243688228053*^9, 
   3.7272437153357477`*^9}, 3.727243873322111*^9, {3.727244012711822*^9, 
   3.7272441246595488`*^9}, {3.7272637417654476`*^9, 
   3.7272637797251816`*^9}, {3.7272638703669715`*^9, 3.72726397181044*^9}, {
   3.7272640038555727`*^9, 3.7272640129468017`*^9}, {3.727264682614747*^9, 
   3.727264924536049*^9}, {3.727264965944425*^9, 3.7272650141695967`*^9}, {
   3.727266421255125*^9, 3.727266531482293*^9}, 3.7272708632677355`*^9, {
   3.7272708958333015`*^9, 3.727270928261586*^9}, {3.7272712154680862`*^9, 
   3.7272712328523192`*^9}, {3.7272720357813473`*^9, 3.727272182872472*^9}, {
   3.7272722914992285`*^9, 3.7272723271210876`*^9}, {3.727272426986003*^9, 
   3.7272725698792715`*^9}, {3.727272654678112*^9, 3.72727267000706*^9}, {
   3.7272727181178446`*^9, 3.727272860300638*^9}, {3.727272973521075*^9, 
   3.7272729991825247`*^9}, {3.7272732792726436`*^9, 3.727273279946619*^9}, {
   3.7278398299736977`*^9, 3.7278398923048754`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "13"}], ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903173349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "19"}], ",", "11"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903173349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "15"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903173349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", 
   RowBox[{"-", "18"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903173349*^9}}],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.02], LineBox[{{-13, 3}, {-19, 11}}], 
   LineBox[{{-1, 15}, {6, -18}}], {PointBox[{-13, 3}], PointBox[{-19, 11}]}, {
    PointBox[{-1, 15}], PointBox[{6, -18}]}, {InsetBox["1", {-13, 3.7}], 
    InsetBox["2", {-19, 11.7}]}, {InsetBox["3", {-1, 15.7}], 
    InsetBox["4", {6, -17.3}]}}]], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903173349*^9}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJyFm11wVdUZhjc5MQYRDIiSCGIgAUJACCAYQpT4A1itNUhrYwsDjG0mzrRT
xjpTZnpB77xMLjqTCy7oHXeiThOmw1hafxprbVOtlLahYhWJ/Rsuueqke631
nX3Wc9Z7co4m5KznXet8e3/fer+cnX2ePv7yyHe/f/zlF1843n7gpeMnRl58
4Yft+3/wUj5UWpBlCx7Pv15rz9zPc1lW/jaX/z+3z31zI/P83O9/vqV1dnb2
3ODg4MWBgQH3b+/U1FTWGOn2+J9LLTdu3JhtbW31r9Lgv5duNjc390xPT3tF
QzrnxOjo6Fw5slL4fubYsWOeuq8F6ZzxkZGR6jkutvnmHDtz5kz1nFdOnjwp
54TjbnJrlue4r8tdXV3uGEuR9CH/c+Ol7u7unx09etS9TPPNmzcbE0npRkv+
yGeHc5q8Wsmdpemenp7w2il3SxdnRnB3VrLx7/VnfWMzivu1p396KOF9gWcz
Y31Z+dHgv5e8tnyGSskcdxST2WD+34be3mxucjhZO5z9xmz0xweztra92UzQ
CMnZoaGh7OyPHvMvrCVX2/PH1atXfaRVkr5KCboT7Z81p3zwXP7IS1jzhp+c
OnVqYTrr/BP54/z587VWRWpjvjtwF7QL3j9bmPKhs/nDHX8NPnoif+QbpRaf
6s0fblNW897AXUW6GN2/2W0pR+kJ7l7bxVCLu7J05VmLu7ULE4j5gyJri1I+
cDF/lDe44CdfyR/lzSy4y7jLfC3uTMuZXMJ3ifzdnnJUleAuNhdjLe6OzR1j
LY76ivlOkb/FKYd1CO6sY2R8fLwWR/5i/kClvpzR+2dLUu5q09VoLY76Etzt
DbdHavHCGKr5DlFfd6Qc+Uu4d4WWdBZcQayKrMV8u6iqlpTDFQSHKwgOV4j5
tkrWCldYmnJUleDImuBwBcFRVTHvEVlblnK4guBwBcHhCoLDFWK+VeTvzpSj
qgSHKwgOVxAc9RXzLSJ/y1MOVxAcriA48hfz+yv1VbjCXSmHKwiO+hIcriA4
XCHmm0V93Z1y5C/h3hVWpLPgCmJVZC3mm0RVrUg5XEFwuILgcIWYd1eyVrhC
a8pRVYIja4LDFQRHVcV8o8haW8rhCoLDFQSHKwgOV4h5l8jfPSlHVQkOVxAc
riA46ivmG0T+VqYcriA4XEFw5C/m60V9rUo5XEFw1JfgcAXB4QoxXyfq696U
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\
\>"]],

Cell[BoxData["\<\"\:043d\:0435 \:043f\:0435\:0440\:0435\:0441\:0435\:043a\
\:0430\:0435\:0442\:0441\:044f\"\>"], "Output",
 CellChangeTimes->{
  3.7272637643926973`*^9, 3.7272640145232377`*^9, 3.727264687069029*^9, 
   3.7272647352660613`*^9, 3.727264926441223*^9, 3.7272650154393697`*^9, 
   3.7272664339262686`*^9, 3.7272664862863307`*^9, 3.727272184962625*^9, {
   3.7272723018250427`*^9, 3.727272328621012*^9}, 3.727272521682294*^9, 
   3.727272570823138*^9, 3.7272726620434575`*^9, {3.727272731737521*^9, 
   3.7272728620046997`*^9}, {3.727272967268464*^9, 3.727272999649193*^9}, {
   3.727273272895651*^9, 3.7272732805278487`*^9}, {3.7278398425430174`*^9, 
   3.727839903188974*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "3", "*)"}]], "Input",
 CellChangeTimes->{{3.7274226493621674`*^9, 3.7274226566850815`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"n", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "15"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "20"}], ",", "20"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", "n", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"P", ",", 
        RowBox[{"P", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
     RowBox[{"Point", "/@", "P"}], ",", " ", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#1", "+", 
           RowBox[{"{", 
            RowBox[{".2", ",", ".7"}], "}"}]}]}], "]"}], "&"}], ",", "P"}], 
      "]"}]}], "}"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"n", "-", "2"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{"i", "+", "2"}]}], ",", 
     RowBox[{"j", "\[LessEqual]", "n"}], ",", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "\[Equal]", "n"}], "&&", 
          RowBox[{"i", "\[NotEqual]", "n"}]}], ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"det1", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], " ", ";",
            "\[IndentingNewLine]", 
           RowBox[{"det2", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"det3", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], " ", ";",
            "\[IndentingNewLine]", 
           RowBox[{"det4", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"det1", "==", "0"}], "&&", " ", 
              RowBox[{"det2", "==", "0"}], "&&", " ", 
              RowBox[{"det3", "==", "0"}], "&&", " ", 
              RowBox[{"det4", "==", "0"}]}], ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}]}], ",", 
               RowBox[{"a", "++"}], ",", 
               RowBox[{"a", "=", "a"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"det1", "*", "det2"}], "<", "0"}], "&&", " ", 
                RowBox[{
                 RowBox[{"det3", "*", "det4"}], "<", "0"}]}], ",", " ", 
               RowBox[{"a", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "n"}], "&&", 
          RowBox[{"j", "\[NotEqual]", "n"}]}], ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"det1", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], " ", ";",
            "\[IndentingNewLine]", 
           RowBox[{"det2", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"det3", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], " ", ";",
            "\[IndentingNewLine]", 
           RowBox[{"det4", " ", "=", " ", 
            RowBox[{"Det", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"det1", "==", "0"}], "&&", " ", 
              RowBox[{"det2", "==", "0"}], "&&", " ", 
              RowBox[{"det3", "==", "0"}], "&&", " ", 
              RowBox[{"det4", "==", "0"}]}], ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
                 "\[LessEqual]", "0"}]}], ",", 
               RowBox[{"a", "++"}], ",", 
               RowBox[{"a", "=", "a"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"det1", "*", "det2"}], "<", "0"}], "&&", " ", 
                RowBox[{
                 RowBox[{"det3", "*", "det4"}], "<", "0"}]}], ",", " ", 
               RowBox[{"a", "++"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], ";"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"a", ">", "0"}], ",", 
   "\"\<\:041d\:0435 \:043f\:0440\:043e\:0441\:0442\:043e\:0439\>\"", ",", 
   " ", "\"\<\:041f\:0440\:043e\:0441\:0442\:043e\:0439\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0GtI02EYBfClSYqZuYxupigzK0ua2Jqbmss1LcF0wlhTXM0Ub9TQjUq2
mEP8YLKQbJm3FCdrgZesSbawhXipkArFGbNRqdO8kVnGUrL/eT88/D6dw+EJ
ll0T5rjRaDQ2dZDF7uWFDSzwLvgfEMD3Icu5LMoAzupVyIgQlsGkSJ8GKA/U
dMH+nUwz5JR9HYHDUzF2kluTzsCX5qOr0HPT7w/Me9dMrHM5ok9Raq64uFAV
ZD8Ni+sPx0OFiJsC2TYV0WDbFMPczxslsCblpAZGbzyuhis6Lz18LpbUw9Lf
6w9hT4TUAB0epnZo5zd0wOyeum5YWyOdg/Mzoy5I7x53Z1OeU1/yhCyLux/M
8skLhEWG8CBYZZEz4BizJBQ6EwbToPyTUUJ0dmfB7bPBKqi+26KFqbzqCniD
k18Fjy1IdXBoObEWahMyOuEHQWkv3PKLaYFhyrdW2BUySXSKhwdgU2zcG1gx
5ByBN/0Vo1C0JLJBSVTmJJxwZUxBt5kc4tZnhu+wXxC6CGuOR61B/k8hMS7N
yzua8g6NTpxr27MLJu1O3Aul9dYAWBQ7TtTc5jKgmCkjRmYuxcOeSRoPNuZW
noVZXeXJ8LW3+iJcvF5H3PeNoyT9ha1qeN7HrIXOvt5ymMlZ1sO/3G33IcP+
qhkqCugt8ERfgRHK2oJNsNj7UDv0OMIkpvIbn0CjyU6cDk/5CFdexI2RHVPJ
E/CLZH0aTqis87Aqf5YocdjcOJQ6o84dduz4l36L8lGf9TKM6RTnQznPooVP
C7MrIeNgazU07Lfq4Q/f9AeQf6b4XsQg9Xelrx7+BwYc1Pk=
  "]],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.7272820076713514`*^9, 3.727282036039575*^9}, 
   3.727282205178003*^9, {3.727422461449273*^9, 3.7274225181184835`*^9}, {
   3.727422630217152*^9, 3.727422688425927*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "16"}], ",", 
     RowBox[{"-", "15"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"19", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"-", "15"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "20"}], ",", 
     RowBox[{"-", "16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "13"}], ",", 
     RowBox[{"-", "5"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7272820076713514`*^9, 3.727282036039575*^9}, 
   3.727282205178003*^9, {3.727422461449273*^9, 3.7274225181184835`*^9}, {
   3.727422630217152*^9, 3.727422688425927*^9}}],

Cell[BoxData[
 GraphicsBox[{
   LineBox[{{-16, -15}, {19, 11}, {
    11, -15}, {-20, -16}, {-13, -5}, {-16, -15}}], 
   {PointSize[
    0.02], {PointBox[{-16, -15}], PointBox[{19, 11}], PointBox[{11, -15}], 
     PointBox[{-20, -16}], PointBox[{-13, -5}]}, {
     InsetBox["1", {-15.8, -14.3}], InsetBox["2", {19.2, 11.7}], 
     InsetBox["3", {11.2, -14.3}], InsetBox["4", {-19.8, -15.3}], 
     InsetBox["5", {-12.8, -4.3}]}}}]], "Output",
 CellChangeTimes->{{3.7272820076713514`*^9, 3.727282036039575*^9}, 
   3.727282205178003*^9, {3.727422461449273*^9, 3.7274225181184835`*^9}, {
   3.727422630217152*^9, 3.7274226884415655`*^9}}],

Cell[BoxData["\<\"\:041f\:0440\:043e\:0441\:0442\:043e\:0439\"\>"], "Output",
 CellChangeTimes->{{3.7272820076713514`*^9, 3.727282036039575*^9}, 
   3.727282205178003*^9, {3.727422461449273*^9, 3.7274225181184835`*^9}, {
   3.727422630217152*^9, 3.72742268845724*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.727422671429738*^9, 3.727422673118387*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7272820169017143`*^9, 3.727282017855838*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.727282004084428*^9, 3.727282033399908*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7272820296624784`*^9, 3.727282030372793*^9}}]
},
WindowSize->{1530, 769},
WindowMargins->{{-5, Automatic}, {Automatic, 1}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3482, 92, 270, "Input"],
Cell[4065, 116, 569, 9, 115, "Output"],
Cell[4637, 127, 407, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5081, 137, 10207, 281, 549, "Input"],
Cell[15291, 420, 660, 12, 30, "Output"],
Cell[15954, 434, 661, 12, 30, "Output"],
Cell[16618, 448, 660, 12, 30, "Output"],
Cell[17281, 462, 660, 12, 30, "Output"],
Cell[17944, 476, 4794, 79, 447, 340, 6, "CachedBoxData", "BoxData", \
"Output"],
Cell[22741, 557, 689, 10, 30, "Output"]
}, Open  ]],
Cell[23445, 570, 121, 2, 30, "Input"],
Cell[CellGroupData[{
Cell[23591, 576, 26603, 648, 977, "Input"],
Cell[50197, 1226, 220, 3, 30, "Output"],
Cell[50420, 1231, 696, 22, 30, "Output"],
Cell[51119, 1255, 635, 12, 273, "Output"],
Cell[51757, 1269, 268, 3, 30, "Output"]
}, Open  ]],
Cell[52040, 1275, 92, 1, 30, "Input"],
Cell[52135, 1278, 94, 1, 30, "Input"],
Cell[52232, 1281, 92, 1, 30, "Input"],
Cell[52327, 1284, 94, 1, 30, "Input"]
}
]
*)

